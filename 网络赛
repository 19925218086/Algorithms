ProblemA.Area
[Description]
Tomakesurethatourcompanyhasthemostimmutablemobilephoneallover
theworld,theMokiadecidetomonitorallthecellphonesonEarth.They
have launched two satellites in order to track the information about
hardnessofthemobilephones.Althoughthesatellitesareabletoscan
all the mobile phones visible to them, unfortunately, with only two
satellites,ourMokiacan'tcoverallsurfaceonEarthsimultaneously.
Onesatellitecanonlymonitorthesurfacewhichisunblocktoitscurrent
location.ThesatellitecanonlybeblockedbytheEarthitself,thatis
tosay,onepointoftheEarth'ssurfaceisvisibletoonesatelliteif
and only if the line between this point and the satellite does not
intersectwithEarth.Norelativisticeffectsareconsidered.
TheCEOofMokia,Steve,wantstogetthecurrentcoverageratioofthe
satellites.Sinceweonlyknowthecurrentlocationofthesatellites,
itisveryhardtoknowtheexactnumberofratio.Tosimplifythistask,
we can consider Earth as a perfect sphere of radius R. With this
simplification,andthelocationsofthesatellites,thistaskispretty
easy.
[Input]
TheinputfileleadswithonelinecontainsthenumberoftestcasesT.
(T<=1000)
Foreachtestcase,thefirstlinecontainsonlyonerealnumberR(0.01
<=R<=10000),indicatingtheradiusofEarth.
The second line and third line each contains three real numbers,
indicatingthecurrentlocationofthetwosatellites(0.01<=X,Y,Z
<=10000).Andyoumayassumetheoriginofcoordinatesystemislocated
onthecenterofEarth,andtwosatellitesareabovethesurfaceofEarth.
Also,allrealnumbershaveatmosttwodigitsafterthedecimalpoint.
-3-[Output]
Foreachtestcases,outputonlyonelinewiththetestnumberandthe
coverage of the two satellites. All coverage should be presented as
percentagesandroundedtofivedecimalplaces.
[SampleInput]
2
1
002
00-2
1
002
00-2.5
[SampleOutput]
Case#1:50.00000%
Case#2:55.00000%
-4-ProblemB.ParadeShow
[Description]
2013 is the 60 anniversary of Nanjing University of Science and
Technology,andtodayhappenstobetheanniversarydate.Onthishappy
festival,schoolauthorityhopesthatthenewstudentstobetrainedfor
theparadeshow.Youshouldplanabettersolutiontoarrangethestudents
bychoosingsomequeuesfromthempreparingtheparadeshow.(onestudent
onlyinonequeueornotbechosen)
Everystudenthasitsownnumber,from1ton.(1<=n<=10^5),andthey
arestandingfrom1tonintheincreasingorderthesamewiththeirnumber
order. According to requirement of school authority, every queue is
consistedofexactlymstudents.Becausestudentswhostandadjacentin
trainingareassignedconsecutivenumber,forbetterarrangement,you
willchooseinstudentswithinconsecutivenumbers.Whenyouchoosethese
mstudents,youwillrearrangetheirnumbersfrom1tom,inthesameorder
withtheirinitialone.
Ifwedivideourstudents’heightsintok(1<=k<=25)level,experience
saysthattherewillexistanbestviewingmodule,representedbyanarray
a[].a[i](1<=i<=m)standsforthestudent’sheightwithnumberi.Infact,
insideaqueue,foreverynumberpairi,j(1<=i,j<=m),iftherelative
biggerorsmallerorequaltorelationshipbetweentheheightofstudent
numberiandtheheightofstudentnumberjisthesamewiththatbetween
-5-a[i]anda[j],thenthequeueiswelldesigned.Givennstudents’height
arrayx[](1<=x[i]<=k),andthebestviewingmodulearraya[],howmany
welldesignedqueuescanwemakeatmost?
[Input]
Multiplecases,endwithEOF.
Firstline,3integers,n(1<=n<=10^5)m(1<=m<=n)k(1<=k<=25),
Secondline,nstudents’heightarrayx[](1<=x[i]<=k,1<=i<=n);
Third line, m integers, best viewing module array a[]
(1<=a[i]<=k,1<=i<=m);
[Output]
Oneinteger,themaximalamountofwelldesignedqueues.
[SampleInput]
10510
2424242424
12121
[SampleOutput]
1
-6-ProblemC.CountThePairs
[Description]
Withthe60thanniversarycelebrationofNanjingUniversityofScience
andTechnologycomingsoon,theuniversitysetsntouristspotstowelcome
guests. Of course, Redwood forests in our university and its
Orychophragmusviolaceusmustberecommendedastoptentouristspots,
probablythebestofall.Someundirectedroadsaremadetoconnectpairs
oftouristspots.Forexample,fromRedwoodforests(supposeit’sa)to
fountainplaza(supposeit’sb),theremayexistanundirectedroadwith
itslengthc.Bytheway,thereismroadstotallyhere.Accidently,these
roads’lengthisaninteger,andallofthemaredifferent.Someofthese
spotscanreachdirectlyorindirectlytosomeotherspots.Forguests,
theyaretravellingfromtouristspotstotouristspott,theycanachieve
somevaluef.Accordingtothestatisticscalculatedandrecordedbyus
inlastyears,Wefoundastrangewaytocalculatethevaluef:
Fromstot,theremayexistlotsofdifferentpaths,guestswilltry
everyoneofthem.Oneparticularpathisconsistedofsomeundirected
roads.Whentheyaretravellinginthispath,theywilltrytoremember
thevalueoflongestroadinthispath.Intheend,guestswillremember
toomanylongestroads’value,sohecannotcatchthemall.But,onething
whichguestswillkeepitinmindisthattheminimalnumberofallthese
longestvalues.Andvaluefisexactlythesamewiththeminimalnumber.
-7-Tom200willrecommendpairs(s,t)(startspot,endspotpointspair)
toguests.Pguestswillcometovisitouruniversity,andeveryoneof
themhasarequirementforvaluef,satisfyingf>=t.Tom200needsyour
help.Foreachrequirement,howmanypairs(s,t)youcanoffer?
[Input]
Multiplecases,endwithEOF.
Firstline:nm
ntouristspots(1<n<=10000),spots’indexstartsfrom0.
mundirectedroads(1<m<=500000).
Nextmlines,3integers,abc
From tourist spot a to tourist spot b, its length is c. 0<a, b<n,
c(0<c<1000000000),allcaredifferent.
Nextoneline,1integer,p(0<p<=100000)
Itmeanspguestscoming.
Nextpline,eachlineoneinteger,t(0<=t)
Thevaluetyouneedtoconsidertosatisfyf>=t.
[Output]
For each guest's requirement value t, output the number of pairs
satisfyingf>=t.
Notice,(1,2),(2,1)aredifferentpairs.
[SampleInput]
21
012
3
1
2
3
3
012
024
-8-125
5
0
2
3
4
5
[SampleOutput]
2
0
6
4
0
-9-ProblemD.DivideGroups
[Description]
Thisyearisthe60thanniversaryofNJUST,andtomakethecelebration
morecolorful,Tom200isgoingtoinvitedistinguishedalumnusbackto
visitandtakephotos.
Aftercarefullyplanning,Tom200announcedhisactivityplan,onethat
containstwocharacters:
1.Whethertheeffectoftheeventaregoodorbadhasnothingtodo
withthenumberofpeoplejoinin.
2.Thelesspeoplejoininginoneactivityknoweachother,themore
interestingtheactivitywillbe.Therefore,thebeststateisthat,one
dosenotknowanyoneexcepthimself.
Theeventappealstoagreatnumberofalumnus,andTom200findsthat
theymaynotknoweachotherormayjustunilaterallyrecognizeothers.
Toimprovetheactivitieseffects,Tom200hastodivideallthosewho
signedupintogroupstotakepartintheactivityatdifferenttime.As
weknow,one'senergyislimited,andTom200canholdactivitytwice.
Tom200alreadyknowstherelationshipofeachtwoperson,buthecannot
dividethembecausethenumberistoolarge.
-10-NowTom200turnstoyouforhelp.Giventheinformation,canyoutell
ifitispossibletocompletethedividingmissiontomakethetwoactivity
inbeststate.
[Input]
Theinputcontainsseveraltestcases,terminatedbyEOF.
Eachcasestartswithapositiveintegern(2<=n<=100),whichmeans
thenumberofpeoplejoiningintheevent.
Nlinesfollow.Thei-thlinecontainssomeintegerswhicharethe
id
ofstudentsthatthei-thstudentknows,terminatedby0.Andtheidstarts
from1.
[Output]
Ifdividedsuccessfully,pleaseoutput"YES"inaline,elseoutput
"NO".
[SampleInput]
3
0
10
120
[SampleOutput]
YES
-11-ProblemE.Polygon
[Description]
Inthisproblem,you'regivenafunctionf(x)=ax^2+bx+c(xin[l,
r])andasimplepolygon.Andweneedyoutofigureoutthelengthoff(x)
inthispolygon.
[Input]
ThereareseveraltestcasesandthecasesendwithEOF.Foreachcase:
Thefirstlinecontainssixintegersn(1<=n<=20000),a(a!=0),b,
c, landr,whicharethetotalofthepointsofthepolygonandthe
parametersofthefunctionandtheseparametersareintherange[-20000,
20000].
Thenextnlinescontainstwointegersxandy,whicharethecoordinate
ofthepointandbothofthemareintherange[-10^9,10^9].Wecanensure
thatthereisaedgebetweeni-thpointand(i+1)-thpoint(1<=i<n)
andthereisaedgebetweenfirstpointandn-thpoint.
[Output]
For each case, output your answer, your answer should rounded to two
decimalplaces.
[SampleInput]
4000-100100
-100
100
1010
-1010
-12-4100-100100
-100
100
1010
-1010
[SampleOutput]
20.00
21.52
-13-ProblemF.Fishhead’sLittleGame
[Description]
Thereisa3by3gridandeachvertexisassignedanumber.
ItlookslikeJiuGongGe,buttheyaredifferent,forwearenotgoing
tofillthecellbuttheedge.Forinstance,
Theruleofthisgameisthateachplayertakesturnstoaddanedge.
Youwillgetonepointiftheedgeyoujustadded,togetherwithedges
already added before, forms a new square (only square of size 1 is
considered).Ofcourse,yougettwopointsifthatedgeformstwosquares.
Noticethatanedgecanbeaddedonlyonce.
Tom200andJerry404isplayingthislittlegame,andhaveplayedn
roundswhenFishheadcomesin.Fishheadwantstoknowwhowillbethe
winner.Canyouhelphim?AssumethatTom200andJerry404arecleverenough
tomakeoptimaldecisionsineachround.EveryGamestartsfromTom200.
addingedge6–>10
formingtwosquarestogettwopoints
-14-[Input]
ThefirstlineoftheinputcontainsasingleintegerT(T<=100),
thenumberoftestcases.
Foreachcase,thefirstlinecontainsanintegersn(12<=n<=24),
whichmeanstheyhavetakentotalnroundsinturn.Nextnlineseach
containstwointegersa,b(a,b<=16)representingthetwoendpoints
oftheedge.
[Output]
Foreachcaseoutputoneline"Case#X:",representingtheXthcase,
starting from 1. If Tom200 wins, print "Tom200" on one line, print
"Jerry404"otherwise.
[SampleInput]
1
15
12
15
26
59
610
910
56
23
37
711
1011
34
67
78
48
[SampleOutput]
Case#1:Tom200
-15-[Hint]
Incase1,Tom200getstwopointswhensheaddedge5->6,twopoints
inedge6->7,onepointin4->8.
-16-ProblemG.SpacecraftMonitoring
[Description]
Inrecentyears,China'sspaceindustryhasmaderapiddevelopment,
andrecentlylaunchedthemannedspacecraftshenzhou10.BeautyAstronaut
WangYapingevenmadealessoninthespacecrafttothewholeworld.It
meansalottoChina'sspacecommunication.AndtheNanjingUniversity
ofScienceandTechnologyalsocontributetheirstrengthincommunication,
radaranddetectingguidance.
Today,therehavebeenmanyaircraftsinspace,theyarecommunicating
witheachotherinair,orwiththegroundmonitoringpointsinground
(includingfixedandmobilemonitoringpoint).Tosimplifytheproblem,
weassumethatalltheaircraftsandgroundmonitoringpointsareallin
theequatorialplane.Aircraftsareallinsynchronousorbit,supposethe
earth’scoreaspoint(0,0).Wealreadyknow:
Everyaircraft’sorgroundmonitoringpoint’sheightRrelativeto
the earth’s core, initial angle A (rad), and some communication
relationshipbetweenthem.
Alsoeveryaircraft’sorgroundmonitoringpoint’scostpriceP.
Andtheground-to-groundpriceperunitdistance:dd,ground-to-air
priceperunitdistance:dk(air-to-groundthesame),air-to-airprice
perunitdistance:kk.
In order to know the general condition of the system, you should
calculate the maximal average cost price of some aircrafts or ground
monitoringpoints.Theaveragecostprice=(thesumofaircrafts’or
groundmonitoringpoints’costprice+communicationcostpricebetween
themifit'sexisting)/(theamountoftheaircraftsorgroundmonitoring
points)
[Input]
Multiplecases,endwithEOF;
Thefirstline,4positiveintegers,n,dd,dk,kk,thereisnaircrafts
orgroundmonitoringpoints,dd,dk,kkisthesamewithdescriptionabove.
Rememberthatwefirstcalculatethedistancebetweentwoobjectsinto
integer,fourtofivehomesinrounding,thencalculatethecommunication
costprice.
Nextnlines,eachrepresentsanaircraftorgroundmonitoringpoint,
-17-ifthefirstletteris‘d’,itmeans“groundmonitoringpoint”inground,
ifthefirstletteris‘k’,itmeans“aircraft”inair,
thenR,A,P,describedabove.
Nextanintegerm,theamountofcommunicationrelationship.
Nextmlines,eachlineislikex,B,y,C(1<=B,C<=n, x,y=‘d’
or‘k’),representsobjectBiscommunicatedwithobjectC,B’stype
isx,C’stypeisy;B,Cisthesequencenumberinparticularkind('d'
or'k')listedabove,startsfrom1.
1<=n<=300,0<=m<=n*n,1<=dd,dk,kk<=10^6,R、Aarefloatingnumbers,
0<=R<=1000,
0<=A<2*PI,1<=P<=10^6。
PS:communicationbetweentwopointsisconsideredasasegment.
[Output]
After“Case#”+casenumber+”:”,casenumberstartsfrom1,
Output2numbers,separatedbyablankspace,firstisthemaximalaverage
costprice,nextistheamountofthispart.Theresultshouldbecorrected
tofourdecimalplaces.
[SampleInput]
2100020003000
d201
d304
1
d1d2
[SampleOutput]
Case#1:502.50002
-18-ProblemH.HeroesofMightandMagic
[Description]
《HeroesofMightandMagicIII:TheRestorationofErathia》isone
ofthemostclassicSLGgameinrecentyears.Itspowerfulstrategiesand
tacticstoattracttheplayersisenduring.Everyonecontrolshisown
combatarmstobattle.Decidetheoutcomeofabattle,inadditiontoa
hero'smagic,level,characteractiongoodorbad,thelayoutofsoldiers
towalk,themostimportantthingisone'sownquantityandqualityof
allkindsofarms.
Jerry404 likes this game so much and later, in order to improve
efficiency,hisfavoriteistheautomaticbattlefunctioninside.
Tom200knowsthatandwonderswhatalgorithmthesystemisthrough
tocalculateitsautomaticallyfight.
After a long time of YY, Tom200 finally speculated the automatic
fightingrules:
1.Eachherocantakeuptosevenarms,andthehero'sattackpower,defense
powerbonustoeachoftheupperarms.Forexample,thehero'sattackpower
anddefensepowerarerespectivelyHaandHd,andthearms'originalattack
-19-poweranddefensepowerareAaandAd.Afteraddition,Aa=Aa+Ha,Ad
=Ad+Hd,andAaisgreaterthan0.
2.Hero'smagicvalueequalsitsintelligencenumber*10.
Hero'smagicinjuryequalsitsstrengthnumber*50.
Heroes’singlecastmagicconsumptionisfixedat12,duringthebattle
theherocannotbeattacked.
3.Eacharmshavefiveattributes:attackpower,defensepower,thevalue
oflife,thenumberofunitsandattackspeed.AssumethatAarmsattack
Barms,AarmsoftheattributewereAa,Ad,Ab,Am,Asandcorrespondingly
Barms'fiveattributeswereBa,Bd,Bb,Bm,Bs.Therefore,thetotal
injuryofAarmsequalsAm*Aa.Atthattime,Barmswillbearthathurt
unitbyunit:
ifAm*AaisnotgreaterthanBd,thenoneunitofBarmswilldeductone
valueoflife;
ifAm*AaisgreaterthanBd,thentheexcesspartoftheattackforce
willbeconsideredasthedeductionofcurrentunit'svalueoflifeof
Barms;
ifoneunit'scurrentlifeofvaluecannotafford,thenitdiesandwe
willtaketheremainderoftheattackforceintothenextunitsettlement.
Alsoatthistime,youshouldcalculateifattackpowerisgreaterthan
defensepower.
if all units of the current arms are dead, injury will no longer be
calculated.
Forexample,assumeAa=5，Am=2，Bd=3，Bb=4，Bm=2,andA'stotal
injuryis10,greaterthanBdby7,andBbis4whichcannotafford.Then
oneunitdiesandtheleftattackpoweris3,notgreaterthanBd,sothe
secondunitdeductonevalueoflife.Finally,theendresultisthatB
armsleft1unitwhoselifeis3.
4.Forbrevity,thearmsinleftandrightattackeachotherinturnevery
round(thearmsintheleftattacksfirst.HeroAisalwaysontheleft,
Bright,eachroundcanonlyattackonceperarms,ifthecurrentround
of a party has no arms to attack, then the side bye). Attack speed
determinesthearmsofthesideorderofattackandthearmsappearfirst
movefirstincaseofthesameattackspeed.Heroesalwaysturntoattack
atthebeginningofeachroundanditsattackeffectscanbecalculated
inthesamewayas(3)describes.Ineveryround,theherocannotattack
ifithasnomagicvalueandinthiscaseitisseenasanattackwithout
injury.Asingleroundendswhenheroesandarmsofbothsidesattacked.
Thefourthrulecanalsolookatthefollowingschematicattackperround：
Aheromagicattack->Bheromagicattack->Afastestattackspeedarms
thatarealive->Bfastestattackspeedarmsthatarealive->Asecond
-20-fastestattackspeedarmsthatarealive->Bfastestattackspeedarms
thatarealive...
5. Assuming that each arms' attack range if full screen and can be
attackedbyeveryotherarms.
6.Theherocanequiptreatmenttent,whichcangetback20pointsof
lifevalueineachround.Thetreatmenttentwillchoosethearmsinwhich
anindividualunithasthemaximumdifferencebetweenremaininglifevalue
andoriginallifevalue.Incaseofthesamemaximumdifference,thetent
willchoosethearmsthatappearfirst(Theamountofoneunit'slifevalue
willnotexceeditsoriginalvalueandthetentcannotbringbackthose
whoarealreadydead.)
7.Everyroundallthearms(includingthehero)willattacktheenemy
armswhichhasthemostnumberofunits.Incaseofthesamenumber,it
willattackthearmsthatappearfirst.
8.Everyroundeacharmswillhaveachanceofcounterattackanditwill
counterattackimmediatelyifitisableto.(Ifattackedbyahero,it
cannotcounterattack.)
9.Aroundendsafterallthearms'movement.
10.Allthenumbersareintegersandthesinglenumbervalueisnogreater
than 100 and no less than 0. Calculations are integer calculations
(roundeddownisallright.)
11.Thegamecomestoendwheneverysingleunitofallthearmsonone
sidearedead.
Tom200wantsyoutotellthefinalendingaccordingtothesecrazyrules.
[Input]
ThefirstlinecontainsanumberTdenotingthenumberofthetest
cases.
The fisrt line of each case are six integers
Aa,Ad,Ae,As,An(1<=An<=7),Azp,indicatingone'sownhero'sattackpower,
defensepower,intelligence,strength,thenumberofarmstheherotakes.
-21-IfAzp=1,itmeansthereisatreatmenttent;elseifAzp=0,thereisno
tent.
FivelinesfollowandeachlinecontainsAnintegers,respectively
indicatingAnarms'attackpower,defensepower,thevalueoflife,the
numberofunitsandattackspeed.
The next line is the corresponding data of the enemy
hero:Ba,Bd,Be,Bs,Bn,Bzp.
FivelinesfollowandeachlinecontainsBnintegers,respectively
indicatingBnarms'attackpower,defensepower,thevalueoflife,the
numberofunitsandattackspeed.
[Output]
Ifone'sownside(Ahero)wins,output"Win!"inaline,elseoutput
"Lose!".
Thenexttwolinesoutputthenumberofdeadunitsofeacharmsin
orderofarmsappearance.
Weensurethatoneside'sarmswillalldie,inotherwordsendless
drawdoesnotexist.
[SampleInput]
1
14351
54321
32100
43221
23456
53211
212140
3324
4352
2112
4321
3245
-22-[SampleOutput]
Win!
00026
4321
-23-ProblemI.InstallAirConditioning
[Description]
NJUSTcarriesonthetraditionofHaJunGong.NJUST,whokeepsupthe”
people-oriented,harmoniousdevelopment”oftheeducationalphilosophy
anddevelopsthe”unity,dedication,truth-seeking,innovation”school
motto, has now become an engineering-based, multidisciplinary
university.
As we all know, Nanjing is one of the four hottest cities in China.
StudentsinNJUSTfindithardtofallasleepduringhotsummereveryyear.
Theywillnever,however,sufferfromthathotthisyear,whichmakesthem
reallyexcited.NJUST’s60thbirthdayisapproaching,inthemeantime,
50millionisspenttoinstallairconditioningamongstudentsdormitories.
DuetoNJUST’slonghistory,theoldcircuitsarenotcapabletocarry
heavyload,soitisnecessarytosetnewhigh-loadwires.Toreducecost,
everywirebetweentwodormitoryisconsideredasegment.Now,knownabout
all the location of dormitories and a power plant, and the cost of
high-load wire per meter, Tom200 wants to know in advance, under the
premiseofalldormitoriesbeingabletosupplyelectricity,theminimum
costbespentonhigh-loadwires.Andthisistheminimumstrategy.But
-24-Tom200 is informed that there are so many wires between two specific
dormitoriesthatwecannotsetanewhigh-loadwirebetweenthesetwo,
otherwiseitmayhavepotentialrisks.TheproblemisthatTom200doesn’
tknowexactlywhichtwodormitoriesuntilthesettingprocessisstarted.
Soaccordingtotheminimumstrategydescribedabove,howmuchcostat
mostyou'llspend?
[Input]
ThefirstlineoftheinputcontainsasingleintegerT(T≤100),the
numberoftestcases.
Foreachcase,thefirstlinecontainstwointegersn(3≤n≤1000),
k(1≤k≤100).nrepresentsn-1dormitoriesandonepowerplant,k
representsthecostofhigh-loadwirepermeter.nlinesfollowedcontains
twointegersx,y(0≤x,y≤10000000),representingthelocationof
dormitoryorpowerplant.Assumenotwolocationsarethesame,andno
three locations are on a straight line. The first one is always the
locationofthepowerplant.
[Output]
Foreachcase,outputthecost,correcttotwodecimalplaces.
[SampleInput]
2
42
00
11
20
31
43
00
11
10
01
-25-[SampleOutput]
9.66
9.00
-26-ProblemJ.Tree
[Description]
ZeroandOnearegoodfriendswhoalwayshavefunwitheachother.This
time,theydecidetodosomethingonatreewhichisakindofgraphthat
thereisonlyonepathfromnodetonode.First,ZerowillgiveOnean
treeandeverynodeinthistreehasavalue.Then,ZerowillaskOnea
seriesofqueries.Eachquerycontainsthreeparameters:x,y,zwhich
meanthathewanttoknowthemaximumvalueproducedbyzxoreachvalue
onthepathfromnodextonodey(includenodex,nodey).Unfortunately,
Onehasnoideainthisquestion.Soheneedyoutosolveit.
[Input]
ThereareseveraltestcasesandthecasesendwithEOF.Foreachcase:
Thefirstlinecontainstwointegersn(1<=n<=10^5)andm(1<=m<=10^5),
whicharetheamountoftree’snodesandqueries,respectively.
Thesecondlinecontainsnintegersa[1..n]anda[i](0<=a[i]<2^{16})is
thevalueontheithnode.
Thenextn–1linescontainstwointegersuv,whichmeansthereisan
connectionbetweenuandv.
Thenextmlinescontainsthreeintegersxyz,whicharetheparameters
ofZero’squery.
[Output]
Foreachquery,outputtheanswer.
-27-[SampleInput]
32
122
12
23
131
232
[SampleOutput]
3
0
-28-ProblemK.WalkThroughSquares
[Description]
Onthebeamingdayof60thanniversaryofNJUST,asamilitarycollege
which was Second Artillery Academy of Harbin Military Engineering
Institutebefore,queuephalanxisaspeciallandscape.
HereisaM*Nrectangle,andthisonecanbedividedintoM*Nsquares
whichareofthesamesize.Asshowninthefigurebelow:
01--02--03--04
|| || || ||
05--06--07--08
|| || || ||
09--10--11--12
Consequently,wehave(M+1)*(N+1)nodes,whichareallconnectedto
theiradjacentnodes.Andactualqueuephalanxwillgoalongtheedges.
TheIDofthefirstnode,theoneintop-leftcorner,is1.AndtheID
increaseslinebylinefirst,andthenbycolumninturn,asshowninthe
figureabove.
Foreverynode,therearetwoviablepaths:
(1)godownward,indicatedby'D';
(2)goright,indicatedby'R';
Thecurrentmissionisthat,eachqueuephalanxhastowalkfromthe
left-topnodeNo.1totheright-bottomnodewhoseidis(M+1)*(N+1).
Inordertomakeamoreaestheticmarching,eachqueuephalanxhas
toconducttwonecessaryactions.Let'sdefinetheaction:
-29-Anactionisstartedfromanodetogoforaspecifiedtravelmode.
So,twoactionsmustshowupinthewayfrom1to(M+1)*(N+1).
Forexample,astoa3*2rectangle,figurebelow:
01--02--03--04
|| || || ||
05--06--07--08
|| || || ||
09--10--11--12
Assumethatthetwoactionsare(1)RRD (2)DDR
Asaresult,thereisonlyoneway:RRDDR.Briefly,youcannotfind
anothersequencecontainingthesetwostringsatthesametime.
IfgiventheN,Mandtwoactions,canyoucalculatethetotalways
ofwalkingfromnodeNo.1totheright-bottomnode?
[Input]
ThefirstlinecontainsanumberT,(Tisabout100,including90small
testcasesand10largeones)denotingthenumberofthetestcases.
Foreachtestcases,thefirstlinecontainstwopositiveintegersM
andN(Forlargetestcases,1<=M,N<=100,andforsmallones1<=M,N<=40).
MdenotestherownumberandNdenotesthecolumnnumber.
Thenexttwolineseachcontainsastringwhichcontainsonly'R'and
'D'.Thelengthofstringwillnotexceed100.Weensuretherearenoempty
stringsandthetwostringsaredifferent.
[Output]
Foreachtestcases,printtheanswerMOD1000000007inoneline.
[SampleInput]
2
32
RRD
DDR
32
R
D
-30-[SampleOutput]
1
